<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#1a5276">
    <meta name="description" content="NeuroNarrative - A privacy-first AI companion designed to help autistic children develop social and emotional skills through engaging conversations">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>üåä NeuroNarrative - Autism-Friendly AI Companion</title>
    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="/css/child.css">
    <link rel="stylesheet" href="/css/ocean.css">
    <link rel="stylesheet" href="/css/animations.css">
    <link rel="stylesheet" href="/css/placeholders.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800;900&family=Fredoka+One&display=swap" rel="stylesheet">

</head>
<body>
    <!-- Full-screen Ocean Background with ALL Assets -->
    <div id="theme-background" class="theme-background ocean-theme">
        <!-- Ocean World with CSS Animations -->
        <div class="ocean-world">
            <div class="ocean-gradient"></div>
            
            <!-- Light Rays -->
            <div class="light-rays">
                <div class="ray"></div>
                <div class="ray"></div>
                <div class="ray"></div>
            </div>
            
            <!-- Bubbles Layer -->
            <div class="bubbles-layer"></div>
            
            <!-- Sand Floor (Bottom Layer) -->
            <img src="/assets/sand-floor.png" class="ocean-asset sand-floor" alt="">
            
            <!-- Coral & Seaweed -->
            <img src="/assets/coral-left.png" class="ocean-asset coral-left" alt="">
            <img src="/assets/coral-right.png" class="ocean-asset coral-right" alt="">
            <img src="/assets/seaweed.png" class="ocean-asset seaweed-left" alt="">
            <img src="/assets/seaweed.png" class="ocean-asset seaweed-right" alt="">
            
            <!-- Treasure & Pearl -->
            <img src="/assets/treasure-chest.png" class="ocean-asset treasure" alt="">
            <img src="/assets/pearl-shell.png" class="ocean-creature pearl" alt="">
            
            <!-- Swimming Creatures -->
            <img src="/assets/happy-fish.png" class="ocean-creature fish-1" alt="">
            <img src="/assets/happy-fish.png" class="ocean-creature fish-2" alt="">
            <img src="/assets/excited-dolphin.png" class="ocean-creature dolphin" alt="">
            <img src="/assets/scared-jellyfish.png" class="ocean-creature jellyfish jellyfish-1" alt="">
            <img src="/assets/scared-jellyfish.png" class="ocean-creature jellyfish jellyfish-2" alt="">
            <img src="/assets/calm-turtle.png" class="ocean-creature turtle" alt="">
            <img src="/assets/sam-octopus.png" class="ocean-creature octopus" alt="">
            <img src="/assets/pete-crab.png" class="ocean-creature crab" alt="">
            <img src="/assets/rita-seahorse.png" class="ocean-creature seahorse" alt="">
            <img src="/assets/angry-puffer.png" class="ocean-creature puffer" alt="">
        </div>
    </div>

    <!-- Login Screen -->
    <div id="login-screen" class="screen active">
        <div class="login-container">
            <h1 class="app-title">üåä NeuroNarrative</h1>
            <p class="subtitle">Privacy-first AI companion for autistic children</p>
            
            <div class="child-selector">
                <div id="child-cards" class="child-cards"></div>
                
                <div class="new-child-form">
                    <h3>Create New Profile</h3>
                    <input type="text" id="new-child-name" placeholder="Enter name" class="input-large">
                    <select id="new-child-age" class="input-large">
                        <option value="">Select Age</option>
                        <option value="5">5 years</option>
                        <option value="6">6 years</option>
                        <option value="7">7 years</option>
                        <option value="8">8 years</option>
                        <option value="9">9 years</option>
                        <option value="10">10 years</option>
                        <option value="11">11 years</option>
                        <option value="12">12 years</option>
                        <option value="13">13 years</option>
                        <option value="14">14 years</option>
                        <option value="15">15 years</option>
                    </select>
                    <button id="btn-create-child" class="btn-primary">Create Profile</button>
                </div>
            </div>
        </div>
    </div>

    <!-- App Screen -->
    <div id="app-screen" class="screen">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="profile-card">
                <div class="profile-avatar-container">
                    <div class="avatar-large" id="profile-avatar">üë¶</div>
                </div>
                <h2 id="profile-name">Child</h2>
                <span class="level-badge" id="profile-level">Level 1</span>
            </div>
            
            <div class="xp-bar-container">
                <div class="xp-label">
                    <span>Progress</span>
                    <span id="xp-value">0 / 100 XP</span>
                </div>
                <div class="xp-bar">
                    <div class="xp-fill" id="xp-fill" style="width: 0%"></div>
                </div>
                <p class="xp-text">Keep talking to level up!</p>
            </div>
            
            <div class="streak-info">
                <span class="streak-emoji">üî•</span>
                <span id="streak-days">0 Day Streak</span>
            </div>
            
            <!-- Theme Selector -->
            <div class="theme-selector-container">
                <h3>üé® Choose Theme</h3>
                <div class="theme-buttons" id="theme-buttons">
                    <button class="theme-btn active" data-theme="ocean" title="Deep Dive">üåä</button>
                    <button class="theme-btn" data-theme="dino" title="Dino Dig">ü¶ï</button>
                    <button class="theme-btn" data-theme="space" title="Star Voyager">üöÄ</button>
                    <button class="theme-btn" data-theme="train" title="Train Tracks">üöÇ</button>
                    <button class="theme-btn" data-theme="clouds" title="Soft Clouds">‚òÅÔ∏è</button>
                </div>
            </div>
            
            <div class="badges-section">
                <h3>üèÜ Your Badges</h3>
                <div class="badges-grid" id="badges-grid">
                    <div class="badge-item locked" title="First Words">üèÖ</div>
                    <div class="badge-item locked" title="Chatty Friend">‚≠ê</div>
                    <div class="badge-item locked" title="Emotion Expert">üí¨</div>
                    <div class="badge-item locked" title="Story Master">üìö</div>
                    <div class="badge-item locked" title="Problem Solver">üß©</div>
                    <div class="badge-item locked" title="Routine Hero">üéØ</div>
                </div>
            </div>
            
            <button id="btn-view-dashboard" class="btn-secondary">üìä View Progress</button>
            <button id="btn-logout" class="btn-secondary">‚Üê Logout</button>
        </div>
        
        <!-- Main Content -->
        <div class="main-content">
            <!-- Character Selection -->
            <div id="character-selection" class="content-panel active">
                <div class="screen-header">
                    <h1 class="page-title">Choose Your AI Friend</h1>
                    <p class="page-subtitle">Pick a character to chat with!</p>
                </div>
                
                <div class="character-grid" id="character-grid">
                    <!-- Characters loaded by JavaScript -->
                </div>
            </div>
            
            <!-- Chat Screen -->
            <div id="chat-screen" class="content-panel">
                <div class="chat-header">
                    <button id="btn-back" class="btn-back">
                        <span>‚Üê</span> Back
                    </button>
                    <div class="chat-title">
                        <img id="chat-character-img" src="" alt="" class="character-avatar-large">
                        <div>
                            <h2 id="chat-character-name">Character</h2>
                            <p id="chat-character-role">Role</p>
                        </div>
                    </div>
                    
                    <!-- Voice Toggle Switch -->
                    <div class="voice-toggle-container">
                        <span class="toggle-label">Type</span>
                        <label class="toggle-switch">
                            <input type="checkbox" id="voice-toggle">
                            <span class="toggle-slider"></span>
                        </label>
                        <span class="toggle-label">üé§ Voice</span>
                    </div>
                    
                    <button id="btn-end-session" class="btn-end-session">End Session</button>
                </div>
                
                <div class="emotion-picker">
                    <p class="emotion-label">How are you feeling?</p>
                    <div class="emotion-buttons" id="emotion-buttons">
                        <button class="emotion-btn" data-emotion="happy">
                            <span class="emotion-emoji">üòä</span>
                            <span>Happy</span>
                        </button>
                        <button class="emotion-btn" data-emotion="sad">
                            <span class="emotion-emoji">üò¢</span>
                            <span>Sad</span>
                        </button>
                        <button class="emotion-btn" data-emotion="angry">
                            <span class="emotion-emoji">üò†</span>
                            <span>Angry</span>
                        </button>
                        <button class="emotion-btn" data-emotion="scared">
                            <span class="emotion-emoji">üò®</span>
                            <span>Scared</span>
                        </button>
                        <button class="emotion-btn" data-emotion="excited">
                            <span class="emotion-emoji">ü§©</span>
                            <span>Excited</span>
                        </button>
                        <button class="emotion-btn" data-emotion="calm">
                            <span class="emotion-emoji">üòå</span>
                            <span>Calm</span>
                        </button>
                    </div>
                </div>
                
                <!-- Main Chat Layout with Emotion Panel -->
                <div class="chat-layout">
                    <!-- Chat Container -->
                    <div class="chat-container">
                        <div class="chat-messages" id="chat-messages"></div>
                        
                        <!-- Anti-Freeze Overlay -->
                        <div id="anti-freeze-overlay" class="anti-freeze-overlay hidden">
                            <div class="anti-freeze-content">
                                <p class="anti-freeze-title">Need help continuing?</p>
                                <div class="anti-freeze-options">
                                    <button class="anti-freeze-btn" data-option="continue">
                                        <span class="option-icon">üí¨</span>
                                        <span class="option-text" id="continue-text">Tell me more</span>
                                    </button>
                                    <button class="anti-freeze-btn" data-option="shift">
                                        <span class="option-icon">üîÑ</span>
                                        <span class="option-text" id="shift-text">Change topic</span>
                                    </button>
                                    <button class="anti-freeze-btn" data-option="break">
                                        <span class="option-icon">‚òï</span>
                                        <span class="option-text">Take a break</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- AI Emotion Expression Panel -->
                    <div class="emotion-panel" id="emotion-panel">
                        <div class="emotion-panel-header">
                            <span class="emotion-panel-title">üåä AI Feeling</span>
                        </div>
                        <div class="emotion-display">
                            <img id="ai-emotion-img" src="/assets/calm-turtle.png" alt="AI Emotion" class="ai-emotion-image">
                            <p id="ai-emotion-label" class="ai-emotion-label">Calm</p>
                        </div>
                        <div class="emotion-hint">
                            <small>Watch how I feel!</small>
                        </div>
                    </div>
                </div>
                
                <!-- Crisis Support Banner -->
                <div id="crisis-banner" class="crisis-banner hidden">
                    <span class="crisis-icon">üíô</span>
                    <span class="crisis-text">I hear you. Let's talk to someone who can help.</span>
                    <a href="tel:9152987821" class="crisis-link">üìû iCall: 9152987821</a>
                    <button class="crisis-close" onclick="document.getElementById('crisis-banner').classList.add('hidden')">√ó</button>
                </div>
                
                <!-- Input Container (changes based on mode) -->
                <div class="message-input-container" id="input-container">
                    <!-- AI Suggested Options Popup -->
                    <div id="ai-options-popup" class="ai-options-popup hidden">
                        <div class="options-header">üí° Try saying:</div>
                        <div class="options-buttons" id="options-buttons"></div>
                    </div>
                    
                    <!-- Text Input Mode -->
                    <div id="text-input-mode" class="input-mode active">
                        <textarea 
                            id="message-input" 
                            class="message-input" 
                            placeholder="Type your message here..."
                            rows="1"
                        ></textarea>
                        <button id="btn-send" class="btn-send">‚û§</button>
                    </div>
                    
                    <!-- Voice Input Mode -->
                    <div id="voice-input-mode" class="input-mode">
                        <button id="btn-record" class="btn-record">
                            <span class="mic-icon">üé§</span>
                            <span class="record-text">Tap to Speak</span>
                        </button>
                        <div id="recording-indicator" class="recording-indicator hidden">
                            <span class="recording-pulse"></span>
                            <span class="recording-text">Listening...</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Parent Dashboard - Enhanced -->
            <div id="parent-dashboard" class="content-panel">
                <div class="dashboard-header">
                    <button id="btn-back-from-dashboard" class="btn-back">
                        <span>‚Üê</span> Back
                    </button>
                    <h1 class="page-title">üåä Progress Dashboard</h1>
                    <div class="dashboard-child-info">
                        <span class="child-avatar-small" id="dashboard-avatar">üë¶</span>
                        <span class="child-name-small" id="dashboard-name">Child</span>
                    </div>
                </div>
                
                <div class="dashboard-content">
                    <!-- Overall Score Card -->
                    <div class="overall-score-section">
                        <div class="overall-score-card">
                            <div class="score-visual">
                                <div class="score-circle" id="score-circle">
                                    <span class="score-number" id="overall-score">0</span>
                                    <span class="score-label">Overall</span>
                                </div>
                            </div>
                            <div class="score-details">
                                <h3 class="score-stage" id="dev-stage">Exploring</h3>
                                <p class="score-description" id="dev-description">Beginning the journey. Be patient and supportive.</p>
                            </div>
                            <div class="score-decoration">
                                <img src="/assets/steve-turtle.png" alt="" class="score-mascot">
                            </div>
                        </div>
                    </div>

                    <!-- Hero Stats -->
                    <div class="hero-stats">
                        <div class="hero-stat level-card">
                            <div class="hero-stat-icon">
                                <img src="/assets/treasure-chest.png" alt="Level" class="hero-icon-img">
                            </div>
                            <div class="hero-stat-content">
                                <span class="hero-stat-value" id="stat-level">1</span>
                                <span class="hero-stat-label">Level Achieved</span>
                            </div>
                        </div>
                        <div class="hero-stat streak-card">
                            <div class="hero-stat-icon">üî•</div>
                            <div class="hero-stat-content">
                                <span class="hero-stat-value" id="stat-streak">0</span>
                                <span class="hero-stat-label">Day Streak</span>
                            </div>
                        </div>
                        <div class="hero-stat xp-card">
                            <div class="hero-stat-icon">
                                <img src="/assets/pearl-shell.png" alt="XP" class="hero-icon-img">
                            </div>
                            <div class="hero-stat-content">
                                <span class="hero-stat-value" id="stat-xp">0</span>
                                <span class="hero-stat-label">Total XP</span>
                            </div>
                        </div>
                    </div>

                    <!-- Milestones Section -->
                    <div class="milestones-section">
                        <h2 class="section-title">üèÜ Developmental Milestones</h2>
                        <div class="milestones-grid" id="milestones-grid">
                            <!-- Filled by JS -->
                        </div>
                    </div>

                    <!-- Main Stats Grid -->
                    <div class="dashboard-grid">
                        <div class="stat-card sessions-card">
                            <div class="stat-icon">üìä</div>
                            <div class="stat-info">
                                <p class="stat-label">Total Sessions</p>
                                <p class="stat-value" id="stat-sessions">0</p>
                            </div>
                            <div class="stat-trend positive">‚Üë Great!</div>
                        </div>
                        
                        <div class="stat-card turns-card">
                            <div class="stat-icon">üí¨</div>
                            <div class="stat-info">
                                <p class="stat-label">Avg Turns/Session</p>
                                <p class="stat-value" id="stat-turns">0</p>
                            </div>
                        </div>
                        
                        <div class="stat-card emoji-card">
                            <div class="stat-icon">üòä</div>
                            <div class="stat-info">
                                <p class="stat-label">Emotion Expression</p>
                                <p class="stat-value" id="stat-emoji">0%</p>
                            </div>
                        </div>
                        
                        <div class="stat-card conversations-card">
                            <div class="stat-icon">üó£Ô∏è</div>
                            <div class="stat-info">
                                <p class="stat-label">Total Conversations</p>
                                <p class="stat-value" id="stat-conversations">0</p>
                            </div>
                        </div>
                    </div>

                    <!-- Charts Row -->
                    <div class="charts-row">
                        <!-- Emotion Distribution Chart -->
                        <div class="chart-card emotion-chart">
                            <h3 class="chart-title">üé≠ Emotion Expression</h3>
                            <div class="emotion-chart-container" id="emotion-chart">
                                <!-- Filled by JS -->
                            </div>
                        </div>

                        <!-- Weekly Activity Chart -->
                        <div class="chart-card activity-chart">
                            <h3 class="chart-title">üìÖ Weekly Activity</h3>
                            <div class="activity-chart-container" id="activity-chart">
                                <!-- Filled by JS -->
                            </div>
                        </div>
                    </div>

                    <!-- Development Metrics -->
                    <div class="development-section">
                        <h2 class="section-title">üå± Development Insights</h2>
                        <div class="development-grid">
                            <div class="development-card">
                                <div class="dev-header">
                                    <span class="dev-icon">üó£Ô∏è</span>
                                    <span class="dev-title">Communication</span>
                                </div>
                                <div class="progress-bars">
                                    <div class="progress-item">
                                        <span class="progress-label">Clarity</span>
                                        <div class="progress-bar">
                                            <div class="progress-fill" id="clarity-bar" style="width: 0%"></div>
                                        </div>
                                        <span class="progress-value" id="clarity-value">0%</span>
                                    </div>
                                    <div class="progress-item">
                                        <span class="progress-label">Engagement</span>
                                        <div class="progress-bar">
                                            <div class="progress-fill engagement" id="engagement-bar" style="width: 0%"></div>
                                        </div>
                                        <span class="progress-value" id="engagement-value">0%</span>
                                    </div>
                                    <div class="progress-item">
                                        <span class="progress-label">Reciprocity</span>
                                        <div class="progress-bar">
                                            <div class="progress-fill reciprocity" id="reciprocity-bar" style="width: 0%"></div>
                                        </div>
                                        <span class="progress-value" id="reciprocity-value">0%</span>
                                    </div>
                                </div>
                            </div>

                            <div class="development-card">
                                <div class="dev-header">
                                    <span class="dev-icon">üß†</span>
                                    <span class="dev-title">Cognitive Skills</span>
                                </div>
                                <div class="progress-bars">
                                    <div class="progress-item">
                                        <span class="progress-label">Sentence Complexity</span>
                                        <div class="progress-bar">
                                            <div class="progress-fill complexity" id="complexity-bar" style="width: 0%"></div>
                                        </div>
                                        <span class="progress-value" id="complexity-value">0</span>
                                    </div>
                                    <div class="progress-item">
                                        <span class="progress-label">Vocabulary</span>
                                        <div class="progress-bar">
                                            <div class="progress-fill vocabulary" id="vocabulary-bar" style="width: 0%"></div>
                                        </div>
                                        <span class="progress-value" id="vocabulary-value">0%</span>
                                    </div>
                                    <div class="progress-item">
                                        <span class="progress-label">Topic Focus</span>
                                        <div class="progress-bar">
                                            <div class="progress-fill topic" id="topic-bar" style="width: 0%"></div>
                                        </div>
                                        <span class="progress-value" id="topic-value">0%</span>
                                    </div>
                                </div>
                            </div>

                            <div class="development-card emotional-card">
                                <div class="dev-header">
                                    <span class="dev-icon">üíñ</span>
                                    <span class="dev-title">Emotional Growth</span>
                                </div>
                                <div class="emotional-stats">
                                    <div class="emotional-stat">
                                        <span class="emotional-number" id="emotion-variety">0</span>
                                        <span class="emotional-label">Emotions Used</span>
                                    </div>
                                    <div class="emotional-stat">
                                        <span class="emotional-number positive-text" id="positive-ratio">0%</span>
                                        <span class="emotional-label">Positive Expressions</span>
                                    </div>
                                    <div class="emotional-stat">
                                        <span class="emotional-number" id="total-expressions">0</span>
                                        <span class="emotional-label">Total Expressions</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Recommendations Section -->
                    <div class="recommendations-section">
                        <h2 class="section-title">üí° Personalized Recommendations</h2>
                        <div class="recommendations-grid" id="recommendations-grid">
                            <!-- Filled by JS -->
                        </div>
                    </div>

                    <!-- AI Report Section -->
                    <div class="ai-report-section">
                        <div class="ai-report-header">
                            <img src="/assets/calm-turtle.png" alt="AI" class="ai-report-avatar">
                            <div>
                                <h2 class="section-title">üåü AI Progress Report</h2>
                                <p class="report-subtitle">Personalized insights for your child's journey</p>
                            </div>
                        </div>
                        <div class="ai-report-content" id="ai-report">
                            <p>Loading personalized report...</p>
                        </div>
                    </div>

                    <!-- Character Usage -->
                    <div class="character-usage-section">
                        <h2 class="section-title">üé≠ Favorite AI Friends</h2>
                        <div class="character-usage-grid" id="character-usage">
                            <!-- Filled by JS -->
                        </div>
                    </div>
                    
                    <!-- Recent Sessions -->
                    <div class="recent-sessions">
                        <h2 class="section-title">üìù Recent Sessions</h2>
                        <div id="session-list" class="session-list"></div>
                    </div>

                    <!-- Badges Earned -->
                    <div class="badges-earned-section">
                        <h2 class="section-title">üèÜ Badges Earned</h2>
                        <div class="badges-earned-grid" id="badges-earned-grid">
                            <!-- Filled by JS -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Load JavaScript -->
    <script src="/js/api.js"></script>
    <script src="/js/app.js"></script>
</body>
</html>
